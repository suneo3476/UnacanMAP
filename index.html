<!DOCTYPE html>
<html>
<head>
<title>UnacanMAP</title>
<style type="text/css">
body {
    background-color: #DDDDDD;
    font: 30px sans-serif;
}
canvas {
    background-color: white;
}
</style>
<script type="text/javascript" src="./processing-1.4.1.min.js"></script>
<script type="text/javascript">
window.onload = function() {
  var canvas = document.getElementsByTagName('canvas')[0];
  // Processing のソースコードが書かれた script 要素
  var codeElm = document.getElementById('processing-code');
  // 要素の内容を取得する
  var code = codeElm.textContent || codeElm.innerText;
  var p1 = new Processing(canvas, code);
};
</script>
<script id="processing-code" type="application/processing">
// processing source write here
var mapDP=
[
['北門',[6,1],[6,1],'r'],
['駐輪場',[8,1],[11,1],'r'],
['北門ストリート',[6,2],[6,16],'r'],
['弓道場',[4,1],[5,1],'t'],
['駐輪場',[3,2],[5,4],'r'],
['共通棟',[7,2],[8,2],'t'],
['タバコ',[9,2],[9,2],'t'],
['物質棟２号館',[3,6],[5,6],'c'],
['情報-物質',[7,5],[10,5],'r'],

['ものづくり館',[1,9],[1,10],'t'],
['次世代ものづくり人材育成センター',[1,12],[1,13],'t'],
['西門',[1,11],[1,11],'r'],

['情報学部１号館',[10,2],[11,2],'c'],
['',[9,3],[9,4],'c'],
['情報学部２号館',[8,4],[11,4],'c'],
['講義棟',[12,3],[12,3],'c'],
['なかにわ',[10,3],[10,3],'r'],
['情報ロード',[11,5],[11,8],'r'],

['北会館',[12,2],[13,2],'t'],
['創造科学技術大学院',[12,6],[13,6],'c'],
['北館ロード',[14,2],[14,8],'r'],
['',[15,3],[16,3],'c'],
['',[15,8],[17,8],'c'],
['',[16,3],[16,8],'c'],
['電子工学研究所',[15,6],[17,6],'c'],
['駐輪場(原付)',[15,2],[16,2],'r'],
['駐輪場(原付)',[17,3],[18,4],'r'],
['電研ロード',[18,5],[18,8],'r'],

['',[8,6],[8,6],'c'],
['',[7,6],[7,8],'c'],
['',[10,6],[10,8],'c'],
['物質棟１号館',[7,8],[10,8],'c'],
['機械物質ロード',[3,7],[5,7],'r'],

['',[3,8],[5,8],'c'],
['機械棟',[3,11],[5,11],'c'],
['',[3,13],[5,13],'c'],
['',[5,8],[5,13],'c'],
['総合棟',[3,9],[4,10],'c'],
['正門ストリート',[7,9],[17,10],'r'],
['正門',[18,9],[18,10],'r'],
['守衛所',[18,11],[18,11],'t'],
['車庫',[18,12],[18,12],'t'],
['駐輪場(自動二輪)',[18,13],[18,14],'r'],
['プール',[18,17],[18,19],'l'],

['',[7,11],[10,11],'c'],
['電気電子棟',[7,13],[10,13],'c'],
['',[9,15],[10,15],'c'],
['',[10,11],[10,15],'c'],
['グラウンド通り',[3,16],[11,16],'r'],
['ものづくりストリート',[2,7],[2,17],'r'],

['南門ストリート',[11,11],[11,23],'r'],
['南門',[11,24],[11,24],'r'],

['附属図書館浜松分館',[12,11],[14,12],'t'],
['',[12,13],[12,13],'t'],
['S-Port',[15,12],[16,12],'t'],

['事務ロード',[17,11],[17,20],'r'],

['合同棟1号館',[15,15],[16,15],'t'],
['保健センター',[14,15],[14,15],'t'],
['合同棟2号館',[13,16],[15,16],'t'],
['',[12,17],[16,17],'r'],

['',[12,20],[16,20],'r'],
['南館ロード',[14,18],[14,23],'r'],
['体育館',[12,18],[13,19],'t'],
['南会館',[15,18],[16,19],'t'],
['武道場',[12,21],[13,22],'t'],
['佐鳴会館',[15,21],[16,22],'t'],
['課外活動共用施設',[15,23],[16,23],'t'],
['高柳記念未来技術創造館',[12,24],[13,24],'t'],
['',[12,23],[13,23],'r'],
['システム工学棟',[8,18],[10,19],'c'],
['駐輪場',[8,20],[10,20],'r'],
['イノベーション社会連携推進機構',[8,23],[10,23],'t'],
['化学実験室',[1,16],[1,17],'t'],
['運動場',[1,18],[7,21],'t'],
['テニスコート',[1,22],[3,23],'t'],
['駐輪場',[4,22],[7,23],'r'],
['駐輪場',[7,24],[10,24],'r'],
['日本庭園',[17,23],[18,24],'t'],
['',[,],[,],'']
];
// var mapDP=
// [
// ['北ゲート',[6,1],[6,1],'r'],
// ['駐輪場',[7,1],[13,1],'r'],
// ['北門ストリート',[6,2],[6,20],'r'],
// ['弓道場',[4,1],[5,1],'t'],
// ['駐輪場',[3,2],[5,4],''],
// ['共通棟',[7,2],[9,2],'c'],
// ['物質棟２号館',[3,6],[5,6],'c'],
// ['情報物質ロード',[7,5],[15,5],'r'],
// ['ものづくり館',[1,11],[1,14],'t'],
// ['次世代ものづくり人材育成センター',[1,16],[1,19],'t'],
// ['西ゲート',[1,15],[1,15],'r'],
// ['情報学部１号館',[11,2],[13,2],'c'],
// ['情報学部２号館',[9,4],[12,4],'c'],
// ['',[10,3],[10,3],'c'],
// ['物質棟１号館',[7,9],[11,9],'c'],
// ['物質棟１号館',[7,6],[7,8],'c'],
// ['物質棟１号館',[11,7],[11,8],'c'],
// ['物質棟１号館',[9,6],[9,6],'c'],
// ['機械物質ロード',[3,7],[5,7],'r'],
// ['機械棟',[3,9],[4,9],'c'],
// ['機械棟',[3,14],[4,14],'c'],
// ['機械棟',[3,17],[4,17],'c'],
// ['機械棟',[5,9],[5,17],'c'],
// ['総合棟',[3,11],[4,12],'c'],
// ['正門ストリート',[7,11],[19,12],'r'],
// ['正門ゲート',[20,11],[20,12],'r'],
// ['守衛所',[20,13],[20,13],'t'],
// ['車庫',[20,14],[20,14],'t'],
// ['駐輪場(自動二輪)',[20,15],[20,18],'r'],
// ['電気電子棟',[7,14],[10,14],'c'],
// ['電気電子棟',[7,17],[10,17],'c'],
// ['電気電子棟',[9,20],[10,20],'c'],
// ['電気電子棟',[11,14],[11,20],'c'],
// ['グラウンド通り',[2,21],[11,21],'r'],
// ['ものづくりストリート',[2,7],[2,22],'r'],
// ['情報ロード',[12,6],[12,10],'r'],
// ['南門ストリート',[12,13],[12,29],'r'],
// ['南門ゲート',[12,30],[12,30],'r'],
// ['講義棟',[14,3],[14,3],'c'],
// ['中庭',[11,3],[11,3],'r'],
// ['北会館',[14,2],[15,2],'t'],
// ['創造科学技術大学院',[13,7],[15,7],'c'],
// ['なにかができるよ！',[13,9],[15,10],'c'],
// ['北館ロード',[16,2],[16,10],'r'],
// ['',[17,3],[18,3],'c'],
// ['電子工学研究所',[17,6],[19,6],'c'],
// ['',[17,9],[19,9],'c'],
// ['',[18,4],[18,5],'c'],
// ['',[18,7],[18,8],'c'],
// ['駐輪場(原付)',[17,2],[18,2],'r'],
// ['駐輪場(原付)',[19,3],[20,4],'r'],
// ['電研ロード',[20,5],[20,10],'r'],
// ['附属図書館浜松分館',[13,14],[16,15],'t'],
// ['',[13,16],[14,17],'t'],
// ['S-Port',[17,15],[18,15],'t'],
// ['事務ロード',[19,13],[19,26],'r'],
// ['合同棟1号館',[16,20],[18,20],'t'],
// ['保健センター',[15,20],[15,20],'t'],
// ['',[18,19],[18,19],'t'],
// ['合同棟2号館',[14,22],[17,22],'t'],
// ['プール',[20,23],[20,25],'l'],
// ['グラウンド通り',[3,21],[11,21],'r'],
// ['',[13,21],[18,21],'r'],
// ['南館ロード',[15,24],[15,29],'r'],
// ['体育館',[13,24],[14,25],'t'],
// ['南会館',[16,24],[18,25],'t'],
// ['武道場',[13,27],[14,27],'t'],
// ['佐鳴会館',[16,27],[16,28],'t'],
// ['',[17,27],[19,27],'t'],
// ['課外活動共用施設',[17,29],[18,29],'t'],
// ['高柳記念未来技術創造館',[13,29],[14,29],'t'],
// ['システム工学棟',[8,24],[11,25],'c'],
// ['駐輪場',[8,26],[11,26],'r'],
// ['イノベーション社会連携推進機構',[8,29],[11,29],'t'],
// ['運動場',[1,22],[7,27],'t'],
// ['テニスコート',[1,28],[3,29],'t'],
// ['駐輪場',[4,29],[7,29],'r'],
// ['駐輪場',[7,30],[11,30],'r'],
// ['日本庭園',[19,28],[20,29],'t'],
// ['',[,],[,],'']
// ];

//explain common bgm ... on the way
var commonBGMDP=[
];

var width=20, height=26, gridSize=28, fontSize=gridSize/4, margin=gridSize/12;
PFont font=createFont('メイリオ',fontSize);
var grid=new String[width][height];
var mouseOverX=mouseOverY=0;
color strokeCity=color(198,57,57);
color strokeTown=color(74,99,214);
color strokeRoute=color(255,173,57);
color strokeLake=color(214,214,165);
color strokeWater=color(49,181,206);
color strokeSea=color(32,72,192);
color fillCity=color(247,107,107);
color fillTown=color(115,140,255);
color fillRoute=color(255,198,82);
color fillLake=color(165,255,255);
color fillWater=color(66,206,222);
color fillSea=color(64,104,200);

void setup(){
	textFont(font,fontSize);
	size(width*gridSize,height*gridSize);
	smooth();
	for(var m=0;m<mapDP.length;m++){
	  var elm=mapDP[m];
	  var name=elm[0];
	  var grid1=elm[1];
	  var grid2=elm[2];
	  var minX=min(grid1[0],grid2[0]);
	  var minY=min(grid1[1],grid2[1]);
	  var difX=grid2[0]-grid1[0];
	  var difY=grid2[1]-grid1[1];
	  for(var x=minX;x<=minX+difX;x++){
			for(var y=minY;y<=minY+difY;y++){
	    	grid[x][y]=name;
	    }
	  }
	}
}

void draw(){
	background(24,165,189);
	//green land
	noStroke();
  fill(140,206,74);
	for(var m=0;m<mapDP.length;	m++){
	  var elm=mapDP[m];
	  var type=elm[3];
	  if(type=='w' || type=='s')
	    continue;
	  var grid1=elm[1];
	  var grid2=elm[2];
	  var minX=min(grid1[0],grid2[0]);
	  var minY=min(grid1[1],grid2[1]);
	  var difX=grid2[0]-grid1[0];
	  var difY=grid2[1]-grid1[1];
	  rect(minX*gridSize-gridSize/3,minY*gridSize-gridSize/3,gridSize*(difX+1)+gridSize*2/3,gridSize*(difY+1)+gridSize*2/3);
	}
	//orange route, blue water route, blue town, red city, lake
	strokeWeight(3.6);
	for(var m=0;m<mapDP.length;m++){
	  var elm=mapDP[m];
	  var name=elm[0];
	  var grid1=elm[1];
	  var grid2=elm[2];
	  var minX=min(grid1[0],grid2[0]);
	  var minY=min(grid1[1],grid2[1]);
	  var difX=grid2[0]-grid1[0];
	  var difY=grid2[1]-grid1[1];
	  var type=elm[3];
	  switch(type){
	    case 'c':
	    stroke(strokeCity);
	    fill(fillCity);
	    break;
	    case 't':
	    stroke(strokeTown);
	    fill(fillTown);
	    break;
	    case 'l':
	    stroke(strokeLake);
	    fill(fillLake);
	    break;
	    case 'w':
	    stroke(strokeWater);
	    fill(fillWater);
	    break;
	    case 's':
	    stroke(strokeSea);
	    fill(fillSea);
	    break;
	    default:
	    stroke(strokeRoute);
	    fill(fillRoute);
	    break;
	  }
	  rect(minX*gridSize+margin,minY*gridSize+margin,gridSize*(difX+1)-margin*2,gridSize*(difY+1)-margin*2);
		//location name
	  fill('#f0f0f0');
	  text(name,minX*gridSize+margin*1.5,minY*gridSize+margin*3,gridSize*(difX+1)-fontSize-margin,gridSize*(difY+1)-fontSize-margin);
	}
 //mouseOver
  if(grid[mouseOverX][mouseOverY]!=null){
  	//共通するBGM名前のリストを得る
  	String commonList;
  	commonList=getCommonBGMNames(grid[mouseOverX][mouseOverY]);
		stroke(129,29,101);
		fill(221,156,198,32);
		//それぞれの名前について当てはまるグリッドを探す
  	for(String listitem: commonList){
		  for(var x=0;x<width;x++){
				for(var y=0;y<height;y++){
					if(grid[x][y]==listitem)
						rect(x*gridSize,y*gridSize,gridSize,gridSize);
				}
			}
  	}
  }

}
void mouseMoved(){
	var mapXY=gridToMap(mouseX,mouseY);
	mouseOverX = mapXY[0];
	mouseOverY = mapXY[1];
}
void mousePressed(){
	var x=mouseX, y=mouseY;
	var mapXY=gridToMap(x,y);
	var mapName=grid[mapXY[0]][mapXY[1]];
	if(mapName==null)
		return;
	var type=getType(mapName);
	console.log(type);
	if(type=='r'){
		// ex:(209ばんどうろ OR 209番道路 OR (pokemon route 209)) (piano OR ピアノ)
		mapName='(+'+mapName+'ばんどうろ OR '+mapName+'番道路 OR (pokemon route '+mapName+'))';
	}else if(type=='w'){
		mapName='(+'+mapName+'ばんすいどう OR '+mapName+'番水道 OR (pokemon route '+mapName+'))';
	}else if(type=='l'){
		mapName=mapName+'のほとり OR '+mapName;
	}
//	mapName+='+(day OR night OR 昼 OR 夜)';
	var urlHead="http://youtube.com/results?search_query=";

	link(urlHead+mapName, "_new");
}
int[] gridToMap(x, y){
	var x=(int)(x/gridSize), y=(int)(y/gridSize);
	return [x,y];
}
String getType(mapName){
	var type='';
	for(var m=0;m<mapDP.length;m++){
	  var elm=mapDP[m];
	  if(elm[0]==mapName)
	  	return elm[3];
	}
	return '';
}
String[] getCommonBGMNames(mapName){
	for(var c=0;c<commonBGMDP.length;c++){
		elm=commonBGMDP[c];
		for(var i=0;i<elm.length;i++){
			if(mapName==elm[i]){
				return elm;
			}
		}
	}
	return [];
}

</script>
</head>
<body>
  <canvas width="780" height="650"></canvas>
</body>
</html>